<!DOCTYPE html>
<html lang="en">

<head>
    <title>MP Development Toolkit</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/theme/css/bootstrap.min.css" type="text/css">

    <!-- Custom Fonts -->
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800'
        rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic,900,900italic'
        rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/theme/font-awesome/css/font-awesome.min.css" type="text/css">

    <!-- Plugin CSS -->
    <link rel="stylesheet" href="/theme/css/animate.min.css" type="text/css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/theme/css/creative.css" type="text/css">
    
     <!--Google Analytics-->
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-61710861-2', 'auto');
            ga('send', 'pageview');
    </script>

</head>

<nav id="mainNav" class="navbar navbar-default navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            <a class="navbar-brand page-scroll" href="/index.html#page-top">MP Development Toolkit</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="page-scroll" href="/blog">News</a>
                </li>
                <li>
                    <a class="page-scroll" href="/about.html">About</a>
                </li>
                <li>
                    <a class="page-scroll" href="/index.html#toolkit">The toolkit</a>
                </li>
                <li class="dropdown">
                    <a href="#" data-toggle="dropdown" class="dropdown-toggle">Documentation <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a href="/mp-content.html">MP Content</a></li>
                        <li><a href="/snippet-guides.html">Snippet Guides</a></li>
                    </ul>
                </li>
                <li>
                    <a class="page-scroll" href="#contact">Contact</a>
                </li>

            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container-fluid -->
</nav>


    <header style="background-image: url(/theme/images/snippetguides.jpg);min-height: 50%;">
        <div class="header-content">
            <div class="header-content-inner">
                <h1>Snippet Guides</h1>
            </div>
        </div>
    </header>
 <section id="documentation">
    <div class="container">
        <div class="row row-offcanvas row-offcanvas-left">
            <!-- sidebar -->
            <div class="col-xs-6 col-sm-3 sidebar-offcanvas" id="sidebar" role="navigation">
                <i class="fa fa-4x fa-sitemap wow bounceIn text-primary" data-wow-delay=".2s"></i>
                <br /><br />

                <ul class="nav">
                    <li><span class="navbarheader">Snippet Guides</span></li>
                    <li class="active"><a href="mp-content.html">Home</a></li>
                    <li><span class="navbarheader">Management Pack</span></li>
                            <li><a href="new-management-pack.html">New Management Pack</a></li>
                    <li><span class="navbarheader">Classes</span></li>
                            <li><a href="new-application-component.html">New Application Component</a></li>
                            <li><a href="new-application-component-with-dependency-monitor.html">New Application Component with dependency monitor</a></li>
                            <li><a href="new-computer-group.html">New Computer Group</a></li>
                            <li><a href="new-computer-role.html">New Computer Role</a></li>
                            <li><a href="new-instance-group.html">New Instance Group</a></li>
                            <li><a href="new-local-application.html">New Local Application</a></li>
                            <li><a href="new-network-node.html">New Network Node</a></li>
 
                       <li><span class="navbarheader">Discoveries</span></li>
                            <li><a href="new-computer-group-discovery.html">New Computer Group Discovery</a></li>
                            <li><a href="new-instance-group-discovery.html">New Instance Group Discovery</a></li>
                            <li><a href="new-registry-discovery.html">New Registry Discovery</a></li>
                            <li><a href="new-wmi-discovery.html">New WMI Discovery</a></li>
                   
                    <li><span class="navbarheader">Monitors</span></li>
                     <li><span class="navbarheader">Rules</span></li>
                            <li><a href="new-windows-event-alert-rule.html">New Windows Event Alert Rule</a></li>
                            <li><a href="new-repeating-windows-event-alert-rule.html">New Repeating Windows Event Alert Rule</a></li>
                            <li><a href="new-windows-performance-collection-rule.html">New Windows Performance Collection Rule</a></li>
                     <li><span class="navbarheader">Presentation</span></li>
                </ul>
                <br />
                <br />
            </div>
    

            <div class="col-xs-12 col-sm-9" style="padding-top: 40px">
                <h1 id="mp-content">New WMI Discovery</h1>
                <p><blockquote>
<p><strong>Before you begin:</strong> Before creating a new discovery you need to decide on a discovery ID and a display name. You should also think about what properties you should discover for the class.</p>
<p>For more information, consult the <em>Management Pack Content</em> document, section <em>Workflow/Element naming</em>.  </p>
<p><a href="/discovery.html">Discovery naming</a></p>
</blockquote>
<p><br />  <br />
If the project is not open in Visual Studio, open it.<br />
Find the folder for the class that you want to discover.</p>
<p><br />
<img alt="Add new item" src="/images/snippetguides.addnewitem.png" title="Add new item" />  <br />
Right-click the folder and choose <code>Add\New Item...</code>.<br />
In the list, select <code>Empty Management Pack Fragment</code>.  </p>
<p><br /><br />
<img alt="Enter fragment name" src="/images/snippetguides.discovery.fragment.png" title="Enter fragment name" /><br />
Enter a name for the fragment. This should be the same the folder with the addition of <code>Discovery</code>.  So if the folder name is <code>ApplicationServerComputerRole</code> the new fragment should be named <code>ApplicationServerComputerRoleDiscovery</code>. Click <code>Add</code>. The fragment is created and opened.</p>
<p><br />
<img alt="Choose snippet" src="/images/snippetguides.discovery.wmi.snippet.png" title="Choose snippet" /><br />
Right-click between the <code>&lt;ManagementPackFragment&gt;</code> tags and select <code>Insert
snippet</code>. Choose <code>MPDevToolkit\Discoveries\WMI</code>. Choose which type of class you want to discover (Computer Role, Local Application, Application Component) and the number of properties.</p>
<p>The snippet is inserted. Follow the appropriate instructions below.</p>
<p><a href="#ComputerRole">Computer Role</a><br />
<a href="#LocalApplication">Local Application</a><br />
<a href="#ApplicationComponent">Application Component</a></p>
<p><br /></p>
<p><a name="ComputerRole"></a><br /><br /></p>
<h3>Computer Role</h3>
<p><br />
<img alt="Enter MPID" src="/images/snippetguides.discovery.mpid.png" title="Enter MPID" /><br />
Enter the MPID and press tab. Enter the description part of the class name. This should be the same name as the fragment where the class was defined. Press <code>tab</code>.</p>
<p><br />
<em>If you have choosen a snippet for a class with one or more properties, do the following 
step for each property. Otherwise, skip this step and continue with WMI Namespace.</em>  </p>
<p><img alt="Enter property ID" src="/images/snippetguides.discovery.property.png" title="Enter property Id" /><br />
Enter the name for the first property. To use Intellisense, press <code>Backspace</code> and then <code>Ctrl+Space</code> and select the correct one. Press <code>tab</code>. <em>Repeat this for each property of your class.</em>  </p>
<p><br />
<img alt="Enter WMI namespace" src="/images/snippetguides.discovery.wmi.namespace.png" title="Enter WMI namespace" /><br />
Enter the WMI namespace or accept the default value. Press <code>tab</code>.  </p>
<p><br />
<img alt="Enter WMI query" src="images/snippetguides.discovery.wmi.query.png" title="Enter WMI query" /><br />
Enter the WMI query. Press <code>tab</code>.  </p>
<p><br />
<img alt="Enter frequency" src="/images/snippetguides.discovery.frequency.png" title="Enter frequency" /> <br />
Enter the frequency in seconds with which the discovery should run. <code>Press tab</code>.</p>
<p><br />
<img alt="Enter display name" src="/images/snippetguides.discovery.displayname.png" title="Enter display name" /> <br />
Enter the display name of the object. Defaults to the targets display name. Press <code>tab</code>.  </p>
<p><br />
<em>If you have choosen a snippet for a class with one or more properties, do the following 
step for each property. Otherwise, skip this step.</em>       </p>
<p><img alt="Enter FieldName" src="/images/snippetguides.discovery.wmi.fieldname.png" title="Enter FieldName" /> <br />
For each property, enter the name of the field returned from the query. Press <code>tab</code>. <em>Repeat this for each property of your class</em>.  </p>
<p><br /><br />
Press enter to stop editing. The discovery is now done.<br />
Save the file/project.</p>
<p><br /></p>
<p><a name="LocalApplication"></a><br /><br /></p>
<h3>Local Application</h3>
<p><img alt="Enter MPID" src="/images/snippetguides.discovery.mpid.png" title="Enter MPID" /><br />
Enter the MPID and press tab. Enter the description part of the class name. This should be the same name as the fragment where the class was defined. Press <code>tab</code>.</p>
<p><br />
<em>If you have choosen a snippet for a class with one or more properties, do the following 
step for each property. Otherwise, skip this step and continue with WMI Namespace.</em>  </p>
<p><img alt="Enter property ID" src="/images/snippetguides.discovery.property.png" title="Enter property Id" /><br />
Enter the name for the first property. To use Intellisense, press <code>Backspace</code> and then <code>Ctrl+Space</code> and select the correct one. Press <code>tab</code>. <em>Repeat this for each property of your class.</em></p>
<p><br />
<img alt="Enter WMI namespace" src="/images/snippetguides.discovery.wmi.namespace.png" title="Enter WMI namespace" /><br />
Enter the WMI namespace or accept the default value. Press <code>tab</code>.  </p>
<p><br />
<img alt="Enter WMI query" src="images/snippetguides.discovery.wmi.query.png" title="Enter WMI query" /><br />
Enter the WMI query. Press <code>tab</code>.  </p>
<p><br />
<img alt="Enter frequency" src="/images/snippetguides.discovery.frequency.png" title="Enter frequency" /> <br />
Enter the frequency in seconds with which the discovery should run. <code>Press tab</code>.</p>
<p><br />
<img alt="Enter display name" src="/images/snippetguides.discovery.displayname.png" title="Enter display name" /> <br />
Enter the display name of the object. Defaults to the targets display name. Press <code>tab</code>.  </p>
<p><br />
<em>If you have choosen a snippet for a class with one or more properties, do the following 
step for each property. Otherwise, skip this step.</em>        </p>
<p><img alt="Enter FieldName" src="/images/snippetguides.discovery.wmi.fieldname.png" title="Enter FieldName" /> <br />
For each property, enter the name of the field returned from the query. Press <code>tab</code>. <em>Repeat this for each property of your class</em>.    </p>
<p><br /><br />
Press enter to stop editing. The discovery is now done.<br />
Save the file/project.</p>
<p><br /></p>
<p><a name="ApplicationComponent"></a><br /><br /></p>
<h3>Application Component</h3>
<p><img alt="Enter MPID" src="images/Discovery.MPID.png" title="Enter MPID" /><br />
Enter the MPID and press tab. Enter the description part of the class name. This should be the same name as the fragment where the class was defined. Press <code>tab</code>.</p>
<p><br />
<img alt="Enter target" src="/images/snippetguides.discovery.target.png" title="Enter target" />
Enter the target class for the discovery. To use Intellisense, press <code>Backspace</code> and then <code>Ctrl+Space</code> and select the correct one. Press <code>tab</code>.</p>
<p><br />
<img alt="Enter property ID" src="/images/snippetguides.discovery.property.png" title="Enter property Id" /><br />
Enter the name for the first property. To use Intellisense, press <code>Backspace</code> and then <code>Ctrl+Space</code> and select the correct one. Press <code>tab</code>. <em>Repeat this for each property of your class.</em>  </p>
<p><br />
<img alt="Enter host" src="/images/snippetguides.discovery.wmi.host.png" title="Enter host" /><br />
Enter the correct host path to the NetworkName property. If Windows.Computer is used as a target class remoce the "Host/" from the path. The number of "Host" entries is determined by how your application component is hosted. Press <code>tab</code>.    </p>
<p><br />
<img alt="Enter WMI namespace" src="/images/snippetguides.discovery.wmi.namespace.png" title="Enter WMI namespace" /><br />
Enter the WMI namespace or accept the default value. Press <code>tab</code>.  </p>
<p><br />
<img alt="Enter WMI query" src="images/snippetguides.discovery.wmi.query.png" title="Enter WMI query" /><br />
Enter the WMI query. Press <code>tab</code>.  </p>
<p><br />
<img alt="Enter frequency" src="/images/snippetguides.discovery.frequency.png" title="Enter frequency" /> <br />
Enter the frequency in seconds with which the discovery should run. <code>Press tab</code>.</p>
<p><br />
<img alt="Enter display name" src="/images/snippetguides.discovery.displayname.png" title="Enter display name" /> <br />
Enter the how the display name of the discovered object should be popluated. Defaults to the same as the server name. </p>
<blockquote>
<p><strong>Note</strong>: Verify the path to the property if the default is used. The number of Host in the path is dependent on the target class. It should match what was entered in the Namespace tag.  </p>
</blockquote>
<p>Press <code>tab</code>. </p>
<p><br />
<em>If you have choosen a snippet for a class with one or more properties, do the following 
step for each property. Otherwise, skip this step.</em>    </p>
<p><img alt="Enter FieldName" src="/images/snippetguides.discovery.wmi.fieldname.png" title="Enter FieldName" /> <br />
For each property, enter the name of the field returned from the query. Press <code>tab</code>. <em>Repeat this for each property of your class</em>.</p>
<p><br /><br />
Press enter to stop editing. The discovery is now done.<br />
Save the file/project.</p>
<p><br /></p></p>
                
                <footer>
                    Version: 1.0<br />
                    Created: 2016-06-02, 19:42<br />
                </footer>
                
            </div>
        </div>
    </div>
</section>



<!-- jQuery -->
<script src="/theme/js/jquery.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/theme/js/bootstrap.min.js"></script>

<!-- Plugin JavaScript -->
<script src="/theme/js/jquery.easing.min.js"></script>
<script src="/theme/js/jquery.fittext.js"></script>
<script src="/theme/js/wow.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/theme/js/creative.js"></script>
</body>

</html>