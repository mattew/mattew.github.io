<!DOCTYPE html>
<html lang="en">

<head>
    <title>MP Development Toolkit</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="http://mpdev.mattew.se/theme/css/bootstrap.min.css" type="text/css">

    <!-- Custom Fonts -->
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800'
        rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic,900,900italic'
        rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="http://mpdev.mattew.se/theme/font-awesome/css/font-awesome.min.css" type="text/css">

    <!-- Plugin CSS -->
    <link rel="stylesheet" href="http://mpdev.mattew.se/theme/css/animate.min.css" type="text/css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="http://mpdev.mattew.se/theme/css/creative.css" type="text/css">
    
     <!--Google Analytics-->
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-61710861-2', 'auto');
            ga('send', 'pageview');
    </script>

</head>

<nav id="mainNav" class="navbar navbar-default navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            <a class="navbar-brand page-scroll" href="http://mpdev.mattew.se/index.html#page-top">MP Development Toolkit</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="page-scroll" href="http://mpdev.mattew.se/blog">News</a>
                </li>
                <li>
                    <a class="page-scroll" href="http://mpdev.mattew.se/about.html">About</a>
                </li>
                <li>
                    <a class="page-scroll" href="http://mpdev.mattew.se/index.html#toolkit">The toolkit</a>
                </li>
                <li class="dropdown">
                    <a href="#" data-toggle="dropdown" class="dropdown-toggle">Documentation <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                        <li><a href="http://mpdev.mattew.se/mp-content.html">MP Content</a></li>
                        <li><a href="http://mpdev.mattew.se/snippet-guides.html">Snippet Guides</a></li>
                    </ul>
                </li>
                <li>
                    <a class="page-scroll" href="#contact">Contact</a>
                </li>

            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container-fluid -->
</nav>


    <header style="background-image: url(http://mpdev.mattew.se/theme/images/snippetguides.jpg);min-height: 50%;">
        <div class="header-content">
            <div class="header-content-inner">
                <h1>Snippet Guides</h1>
            </div>
        </div>
    </header>
 <section id="documentation">
    <div class="container">
        <div class="row row-offcanvas row-offcanvas-left">
            <!-- sidebar -->
            <div class="col-xs-6 col-sm-3 sidebar-offcanvas" id="sidebar" role="navigation">
                <i class="fa fa-4x fa-sitemap wow bounceIn text-primary" data-wow-delay=".2s"></i>
                <br /><br />

                <ul class="nav">
                    <li><span class="navbarheader">Snippet Guides</span></li>
                    <li class="active"><a href="mp-content.html">Home</a></li>
                    <li><span class="navbarheader">Management Pack</span></li>
                            <li><a href="new-management-pack.html">New Management Pack</a></li>
                    <li><span class="navbarheader">Classes</span></li>
                            <li><a href="new-application-component.html">New Application Component</a></li>
                            <li><a href="new-application-component-with-dependency-monitor.html">New Application Component with dependency monitor</a></li>
                            <li><a href="new-computer-group.html">New Computer Group</a></li>
                            <li><a href="new-computer-role.html">New Computer Role</a></li>
                            <li><a href="new-instance-group.html">New Instance Group</a></li>
                            <li><a href="new-local-application.html">New Local Application</a></li>
                            <li><a href="new-network-node.html">New Network Node</a></li>
 
                       <li><span class="navbarheader">Discoveries</span></li>
                            <li><a href="new-computer-group-discovery.html">New Computer Group Discovery</a></li>
                            <li><a href="new-instance-group-discovery.html">New Instance Group Discovery</a></li>
                            <li><a href="new-registry-discovery.html">New Registry Discovery</a></li>
                            <li><a href="new-wmi-discovery.html">New WMI Discovery</a></li>
                   
                    <li><span class="navbarheader">Monitors</span></li>
                     <li><span class="navbarheader">Rules</span></li>
                            <li><a href="new-windows-event-alert-rule.html">New Windows Event Alert Rule</a></li>
                            <li><a href="new-repeating-windows-event-alert-rule.html">New Repeating Windows Event Alert Rule</a></li>
                            <li><a href="new-windows-script-performance-collection-rule.html">New Windows Script Performance Collection Rule</a></li>
                            <li><a href="new-windows-event-collection-rule.html">New Windows Event Collection Rule</a></li>
                            <li><a href="new-windows-event-range-collection-rule.html">New Windows Event Range Collection Rule</a></li>
                     <li><span class="navbarheader">Presentation</span></li>
                </ul>
                <br />
                <br />
            </div>
    

            <div class="col-xs-12 col-sm-9" style="padding-top: 40px">
                <h1 id="mp-content">New Registry Discovery</h1>
                <p><blockquote>
<p><strong>Before you begin:</strong> Before creating a new discovery you need to decide on a discovery ID and a display name. You should also think about what properties you should discover for the class.</p>
<p>For more information, consult the <em>Management Pack Content</em> document, section <em>Workflow/Element naming</em>.  </p>
<p><a href="http://mpdev.mattew.se/discovery.html">Discovery naming</a></p>
</blockquote>
<p><br />  <br />
If the project is not open in Visual Studio, open it.<br />
Find the folder for the class that you want to discover.  </p>
<p><br />
<img alt="Add new item" src="http://mpdev.mattew.se/images/snippetguides.addnewitem.png" title="Add new item" />  <br />
Right-click the folder and choose <code>Add\New Item...</code>.<br />
In the list, select <code>Empty Management Pack Fragment</code>.</p>
<p><br /><br />
<img alt="Enter fragment name" src="http://mpdev.mattew.se/images/snippetguides.discovery.fragment.png" title="Enter fragment name" /><br />
Enter a name for the fragment. This should be the same the folder with the addition of <code>Discovery</code>.  So if the folder name is <code>ApplicationServerComputerRole</code> the new fragment should be named <code>ApplicationServerComputerRoleDiscovery</code>. Click <code>Add</code>. The fragment is created and opened.</p>
<p><br />
<img alt="Choose snippet" src="http://mpdev.mattew.se/images/snippetguides.discovery.registry.snippet.png" title="Choose snippet" /><br />
Right-click between the <code>&lt;ManagementPackFragment&gt;</code> tags and select <code>Insert
snippet</code>. Choose <code>MPDevToolkit\Discoveries\Registry</code>. Choose which type of class you want to discover (Computer Role, Local Application, Application Component) and the number of properties.</p>
<p>The snippet is inserted. Follow the appropriate instructions below.</p>
<p><a href="#ComputerRole">Computer Role</a><br />
<a href="#LocalApplication">Local Application</a><br />
<a href="#ApplicationComponent">Application Component</a></p>
<p><br /></p>
<p><a name="ComputerRole"></a><br /><br /></p>
<h3>Computer Role</h3>
<p><br />
<img alt="Enter MPID" src="http://mpdev.mattew.se/images/snippetguides.discovery.mpid.png" title="Enter MPID" /><br />
Enter the MPID and press tab. Enter the description part of the class name. This should be the same name as the fragment where the class was defined. Press <code>tab</code>.</p>
<p><br />
<em>If you have choosen a snippet for a class with one or more properties, do the following 
step for each property. Otherwise, skip this step and continue with Registry Key Name.</em>  </p>
<p><img alt="Enter property ID" src="http://mpdev.mattew.se/images/snippetguides.discovery.property.png" title="Enter property Id" /><br />
Enter the name for the first property. To use Intellisense, press <code>Backspace</code> and then <code>Ctrl+Space</code> and select the correct one. Press <code>tab</code>. <em>Repeat this for each property of your class.</em></p>
<p><br />
<img alt="Enter registry key name" src="http://mpdev.mattew.se/images/snippetguides.discovery.registry.keyname.png" title="Enter registry key name" /><br />
Enter the name of the registry key that the discovery should look for. Existance of this key determins if the class should be created. </p>
<blockquote>
<p><strong>Note</strong> The AttributeName can't contain any spaces or dots. So if the registry key contains spaces they must be removed when entered here. But in the path tag the key name must be exact so you have to replace them again. </p>
</blockquote>
<p>Press <code>tab</code>. Enter the subkey of HKLM. It defaults to <code>SOFTWARE</code>. Press <code>tab</code>. Enter the registry path to the key. Press <code>tab</code>.  </p>
<blockquote>
<p><strong>Note</strong> The snippet automatically has added the key name to the end of the path.</p>
</blockquote>
<p><br />
<em>If you have choosen a snippet for a class with one or more properties, do the following 
step for each property. Otherwise, skip this stepp and continue with Frequency.</em></p>
<p><img alt="Enter property value name, path and type" src="http://mpdev.mattew.se/images/snippetguides.discovery.registry.propertykey.png" title="Enter property value name, path and type" />  <br />
Enter the name of the registry value that should populate the property. Press <code>tab</code>.<br />
Enter the registry path to the value, </p>
<blockquote>
<p><strong>Note:</strong> The snippet automatically has added the value name to the end of the path. Press <code>tab</code>.  </p>
</blockquote>
<p>Choose the type of value. It should be one of the following:</p>
<ul>
<li>1 - String: converting result value to string.</li>
<li>2 - Integer: converting result value to number.</li>
<li>3 - Float: converting result value to float.</li>
</ul>
<p>Press <code>tab</code>. <em>Repeat this for each property of your class.</em></p>
<p><br />
<img alt="Enter frequency" src="http://mpdev.mattew.se/images/snippetguides.discovery.frequency.png" title="Enter frequency" /> <br />
Enter the frequency in seconds with which the discovery should run. <code>Press tab</code>.</p>
<p><br />
Press <code>enter</code> to stop editing. The discovery is now done.  </p>
<blockquote>
<p><strong>Note</strong> If your registry key contains any spaces, check the registry paths again to verify that they are correct. Also check the path in the discovery description.</p>
</blockquote>
<p>Save the file/project.</p>
<p><br /></p>
<p><a name="LocalApplication"></a><br /><br /></p>
<h3>Local Application</h3>
<p><br />
<img alt="Enter MPID" src="http://mpdev.mattew.se/images/snippetguides.discovery.mpid.png" title="Enter MPID" /><br />
Enter the MPID and press tab. Enter the description part of the class name. This should be the same name as the fragment where the class was defined. Press <code>tab</code>.</p>
<p><br />
<em>If you have choosen a snippet for a class with one or more properties, do the following 
step for each property. Otherwise, skip this step and continue with Registry Key Name.</em>  </p>
<p><img alt="Enter property ID" src="http://mpdev.mattew.se/images/snippetguides.discovery.property.png" title="Enter property Id" /><br />
Enter the name for the first property. To use Intellisense, press <code>Backspace</code> and then <code>Ctrl+Space</code> and select the correct one. Press <code>tab</code>. <em>Repeat this for each property of your class.</em></p>
<p><br />
<img alt="Enter registry key name" src="http://mpdev.mattew.se/images/snippetguides.discovery.registry.keyname.png" title="Enter registry key name" /><br />
Enter the name of the registry key that the discovery should look for. Existance of this key determins if the class should be created. </p>
<blockquote>
<p><strong>Note</strong> The AttributeName can't contain any spaces or dots. So if the registry key contains spaces they must be removed when entered here. But in the path tag the key name must be exact so you have to replace them again. </p>
</blockquote>
<p>Press <code>tab</code>. Enter the subkey of HKLM. It defaults to <code>SOFTWARE</code>. Press <code>tab</code>. Enter the registry path to the key. Press <code>tab</code>.  </p>
<blockquote>
<p><strong>Note</strong> The snippet automatically has added the key name to the end of the path.</p>
</blockquote>
<p><br />
<em>If you have choosen a snippet for a class with one or more properties, do the following 
step for each property. Otherwise, skip this stepp and continue with Frequency.</em></p>
<p><img alt="Enter property value name, path and type" src="http://mpdev.mattew.se/images/snippetguides.discovery.registry.propertykey.png" title="Enter property value name, path and type" />  <br />
Enter the name of the registry value that should populate the property. Press <code>tab</code>.<br />
Enter the registry path to the value, </p>
<blockquote>
<p><strong>Note:</strong> The snippet automatically has added the value name to the end of the path. Press <code>tab</code>.  </p>
</blockquote>
<p>Choose the type of value. It should be one of the following:</p>
<ul>
<li>1 - String: converting result value to string.</li>
<li>2 - Integer: converting result value to number.</li>
<li>3 - Float: converting result value to float.</li>
</ul>
<p>Press <code>tab</code>. <em>Repeat this for each property of your class.</em></p>
<p><br />
<img alt="Enter frequency" src="http://mpdev.mattew.se/images/snippetguides.discovery.frequency.png" title="Enter frequency" /> <br />
Enter the frequency in seconds with which the discovery should run. <code>Press tab</code>.</p>
<p><br />
Press <code>enter</code> to stop editing. The discovery is now done.  </p>
<blockquote>
<p><strong>Note</strong> If your registry key contains any spaces, check the registry paths again to verify that they are correct. Also check the path in the discovery description.</p>
</blockquote>
<p>Save the file/project.</p>
<p><br /></p>
<p><a name="ApplicationComponent"></a><br /><br /></p>
<h3>Application Component</h3>
<p><br />
<img alt="Enter MPID" src="http://mpdev.mattew.se/images/snippetguides.discovery.mpid.png" title="Enter MPID" /><br />
Enter the MPID and press tab. Enter the description part of the class name. This should be the same name as the fragment where the class was defined. Press <code>tab</code>.</p>
<p><br />
<img alt="Enter target" src="http://mpdev.mattew.se/images/snippetguides.discovery.target.png" title="Enter target" />
Enter the target class for the discovery. To use Intellisense, press <code>Backspace</code> and then <code>Ctrl+Space</code> and select the correct one. Press <code>tab</code>.</p>
<p><br />
<img alt="Enter property ID" src="http://mpdev.mattew.se/images/snippetguides.discovery.property.png" title="Enter property Id" /><br />
Enter the name for the first property. To use Intellisense, press <code>Backspace</code> and then <code>Ctrl+Space</code> and select the correct one. Press <code>tab</code>. <em>Repeat this for each property of your class.</em></p>
<p><br />
<img alt="Enter registry key name" src="http://mpdev.mattew.se/images/snippetguides.discovery.registry.keyname.png" title="Enter registry key name" /><br />
Enter the name of the registry key that the discovery should look for. Existance of this key determins if the class should be created. </p>
<blockquote>
<p><strong>Note</strong> The AttributeName can't contain any spaces or dots. So if the registry key contains spaces they must be removed when entered here. But in the path tag the key name must be exact so you have to replace them again. </p>
</blockquote>
<p>Press <code>tab</code>. Enter the subkey of HKLM. It defaults to <code>SOFTWARE</code>. Press <code>tab</code>. Enter the registry path to the key. Press <code>tab</code>.  </p>
<blockquote>
<p><strong>Note</strong> The snippet automatically has added the key name to the end of the path.</p>
</blockquote>
<p><br />
<em>If you have choosen a snippet for a class with one or more properties, do the following 
step for each property. Otherwise, skip this stepp and continue with Frequency.</em></p>
<p><img alt="Enter property value name, path and type" src="http://mpdev.mattew.se/images/snippetguides.discovery.registry.propertykey.png" title="Enter property value name, path and type" />  <br />
Enter the name of the registry value that should populate the property. Press <code>tab</code>.<br />
Enter the registry path to the value, </p>
<blockquote>
<p><strong>Note:</strong> The snippet automatically has added the value name to the end of the path. Press <code>tab</code>.  </p>
</blockquote>
<p>Choose the type of value. It should be one of the following:</p>
<ul>
<li>1 - String: converting result value to string.</li>
<li>2 - Integer: converting result value to number.</li>
<li>3 - Float: converting result value to float.</li>
</ul>
<p>Press <code>tab</code>. <em>Repeat this for each property of your class.</em></p>
<p><br />
<img alt="Enter frequency" src="http://mpdev.mattew.se/images/snippetguides.discovery.frequency.png" title="Enter frequency" /> <br />
Enter the frequency in seconds with which the discovery should run. <code>Press tab</code>.</p>
<p><br />
<img alt="Enter display name" src="http://mpdev.mattew.se/images/snippetguides.discovery.displayname.png" title="Enter display name" /> <br />
Enter the display name of the object. Defaults to the targets display name. Press <code>tab</code>.</p>
<p><br />
Press <code>enter</code> to stop editing. The discovery is now done.  </p>
<blockquote>
<p><strong>Note</strong> If your registry key contains any spaces, check the registry paths again to verify that they are correct. Also check the path in the discovery description.</p>
</blockquote>
<p>Save the file/project.</p></p>
                
                <footer>
                    Version: 1.0<br />
                    Created: 2016-05-30, 08:12<br />
                </footer>
                
            </div>
        </div>
    </div>
</section>



<!-- jQuery -->
<script src="http://mpdev.mattew.se/theme/js/jquery.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="http://mpdev.mattew.se/theme/js/bootstrap.min.js"></script>

<!-- Plugin JavaScript -->
<script src="http://mpdev.mattew.se/theme/js/jquery.easing.min.js"></script>
<script src="http://mpdev.mattew.se/theme/js/jquery.fittext.js"></script>
<script src="http://mpdev.mattew.se/theme/js/wow.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="http://mpdev.mattew.se/theme/js/creative.js"></script>
</body>

</html>